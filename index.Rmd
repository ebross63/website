---
title: "dplyr"
output: html_document
---

### Filtering Columns and Rows

When using dplyr, you can filter columns and rows by using select and filter. Let's look examples using the Lahman baseball database. We first have to load the "Lahman" and "dplyr" packages. 


```{r message=FALSE, warning=FALSE}
library(Lahman)
library(dplyr)
```

Now, suppose we would like to see the homerun totals for the 1927 New York Yankees. We could run the following code:

```{r warning=FALSE}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(teamID=='NYA' & yearID==1927)
```

To find all instances of Yankees having at least 40 home runs, use the following:

```{r warning=FALSE}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(HR>=40 & teamID=='NYA')
```

Or, reverse filter and select for the same result:

```{r warning=FALSE}
Batting%>%
  filter(HR>=40 & teamID=='NYA')%>%
  select(playerID,yearID,teamID,HR)

```

Use the code below to find all instances of players (from any team) having more than 40 homeruns and less than 60 strikeouts: 

```{r warning=FALSE}
Batting%>%
  select(playerID,yearID,teamID,HR,SO)%>%
  filter(HR>40 & SO<60)

```

Use multiple filters to find all instances of Philadelphia players from the 1970's that had greater than 30 homeruns:

```{r warning=FALSE}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(yearID>=1970 & yearID<=1979 & HR>30 & teamID == 'PHI')

```

###Ordering Results

Find all instances of a player having more than 50 home runs.
Use the following to show the number of home runs in descending order:

```{r warning=FALSE}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(HR>50)%>%
  arrange(desc(HR))

```

Find all instances of a player striking out less than 10 times. Only include players with at least 400 at bats. 
Show the list in ascending order of strikeouts:

```{r warning=FALSE}
Batting%>%
  select(playerID,yearID,teamID,SO,AB)%>%
  filter(SO<10 & AB>=400)%>%
  arrange(SO)

```

###Aggregation

Find total home runs by Babe Ruth

```{r warning = FALSE}
Batting%>%
  filter(playerID=='ruthba01')%>%
  group_by(playerID)%>%
  summarize(career_HR=sum(HR))

```

Find career home run totals for all players, but limit the list to those who have a career total of 600 or more
Put the highest totals at the top

```{r warning=FALSE}
Batting%>%
  group_by(playerID)%>%
  summarize(career_HR=sum(HR))%>%
  filter(career_HR>=600)%>%
  arrange(desc(career_HR))

```

What players have the highest average per season home run totals?

```{r warning=FALSE}
Batting%>%
  group_by(playerID)%>%
  summarize(avg_HR=mean(HR))%>%
  filter(avg_HR>=30)%>%
  arrange(desc(avg_HR))

```

What players, since 1970, have hit more than 50 home runs, at least once?

```{r warning=FALSE}
Batting%>%
  filter(yearID>=1970)%>%
  group_by(playerID)%>%
  summarize(max_HR=max(HR))%>%
  filter(max_HR>50)%>%
  arrange(desc(max_HR))%>%
  select(playerID)

```



